--// Control Panel UI with Teleporter + Auto Accept + Leave
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- âœ… Auto Accept Pets (naka-on agad)
local success, acceptEvent = pcall(function()
    return ReplicatedStorage:WaitForChild("GameEvents"):WaitForChild("AcceptPetGift")
end)

if success and acceptEvent then
    acceptEvent.OnClientEvent:Connect(function(petData)
        acceptEvent:FireServer(petData) 
    end)
end

-- âœ… Main GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ControlPanel"
screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Frame (box UI)
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 300, 0, 280)
mainFrame.Position = UDim2.new(0.5, -150, 0.5, -140)
mainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
mainFrame.BorderSizePixel = 0
mainFrame.Visible = true
mainFrame.Parent = screenGui

-- âœ… Logo Button (pabilog minimize)
local logoBtn = Instance.new("TextButton")
logoBtn.Size = UDim2.new(0, 40, 0, 40)
logoBtn.Position = UDim2.new(0, 10, 0, 10)
logoBtn.Text = "ðŸŒ€"
logoBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
logoBtn.Font = Enum.Font.SourceSansBold
logoBtn.TextSize = 20
logoBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
logoBtn.BorderSizePixel = 0
logoBtn.Parent = mainFrame

-- âœ… Teleporter List (ScrollingFrame)
local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.new(0, 280, 0, 160)
scroll.Position = UDim2.new(0, 10, 0, 60)
scroll.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
scroll.BorderSizePixel = 0
scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
scroll.ScrollBarThickness = 6
scroll.Parent = mainFrame

local listLayout = Instance.new("UIListLayout")
listLayout.Parent = scroll
listLayout.Padding = UDim.new(0, 5)

-- Function: Create Teleport Button for each Player
local function createPlayerBtn(player)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -5, 0, 40)
    btn.Text = player.Name
    btn.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Parent = scroll

    btn.MouseButton1Click:Connect(function()
        local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
        local targetChar = player.Character
        if character and targetChar and targetChar:FindFirstChild("HumanoidRootPart") then
            character:MoveTo(targetChar.HumanoidRootPart.Position + Vector3.new(0,3,0))
        end
    end)
end

-- Gumawa ng button para sa lahat ng existing players
for _, plr in pairs(Players:GetPlayers()) do
    if plr ~= LocalPlayer then
        createPlayerBtn(plr)
    end
end

-- Kapag may bagong sumali, dagdag button
Players.PlayerAdded:Connect(function(plr)
    if plr ~= LocalPlayer then
        createPlayerBtn(plr)
    end
end)

-- Kapag umalis, burahin button
Players.PlayerRemoving:Connect(function(plr)
    for _, child in pairs(scroll:GetChildren()) do
        if child:IsA("TextButton") and child.Text == plr.Name then
            child:Destroy()
        end
    end
end)

-- âœ… Leave Button
local leaveBtn = Instance.new("TextButton")
leaveBtn.Size = UDim2.new(0, 200, 0, 40)
leaveBtn.Position = UDim2.new(0.5, -100, 1, -45)
leaveBtn.Text = "Leave Game"
leaveBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
leaveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
leaveBtn.Parent = mainFrame

leaveBtn.MouseButton1Click:Connect(function()
    LocalPlayer:Kick("You left the game.")
end)

-- âœ… Minimize Function sa Logo Button
local minimized = false
logoBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    for _, child in pairs(mainFrame:GetChildren()) do
        if child ~= logoBtn then
            child.Visible = not minimized
        end
    end
end)
